<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Car Racing Game - Enhanced</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: #111; overflow: hidden; font-family: 'Arial', sans-serif; }
        #gameContainer { position: relative; width: 100vw; height: 100vh; -webkit-tap-highlight-color: transparent; overflow: hidden; }
        canvas { width: 100%; height: 100%; display: block; }
        .hidden { display: none !important; }

        /* --- Control Buttons --- */
        .control-btn {
            position: absolute;
            bottom: 60px;
            width: 70px; height: 70px;
            background-color: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            color: white; font-size: 40px; font-weight: bold;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer; user-select: none; z-index: 10;
        }
        .control-btn:active { background-color: rgba(255, 255, 255, 0.3); }
        #leftButton { left: 20px; }
        #rightButton { right: 20px; }
        
        /* --- Start Screen & Home Screen --- */
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('assets/images/road.jpg') no-repeat center center;
            background-size: cover;
            color: white; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            z-index: 20; text-shadow: 3px 3px 5px #000;
        }
        .screen h1 { font-size: 12vw; margin-bottom: 30px; }

        /* --- Gender Selector --- */
        #genderSelector { display: flex; gap: 20px; margin-bottom: 40px; }
        .gender-btn {
            font-size: 5vw; padding: 15px 40px; cursor: pointer;
            background-color: rgba(255, 255, 255, 0.2); border: 2px solid #fff;
            border-radius: 15px; font-weight: bold;
            transition: background-color 0.3s, transform 0.1s;
        }
        .gender-btn.selected, .gender-btn:hover { background-color: #4CAF50; }
        .gender-btn:active { transform: scale(0.95); }

        /* --- Difficulty Selector (Image Buttons) --- */
        #difficultySelector { display: flex; flex-direction: column; gap: 20px; }
        .difficulty-btn img {
            width: 250px; max-width: 60vw; cursor: pointer;
            transition: transform 0.2s, filter 0.2s;
        }
        .difficulty-btn img:hover { transform: scale(1.05); filter: brightness(1.2); }
        .difficulty-btn img:active { transform: scale(0.98); }

        /* --- Settings and Garage Icons --- */
        .icon-btn {
            position: absolute;
            top: 20px; width: 50px; height: 50px;
            cursor: pointer; z-index: 25;
            transition: transform 0.2s;
        }
        .icon-btn:hover { transform: scale(1.1); }
        #settingsButton { right: 20px; }
        #garageButton { right: 90px; }

        /* --- Modals (Settings & Garage) --- */
        .modal {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 30; display: flex; justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #222; padding: 30px;
            border-radius: 20px; border: 3px solid #4CAF50;
            width: 80%; max-width: 500px;
            text-align: center;
        }
        .modal-content h2 { font-size: 6vw; margin-bottom: 20px; }
        #closeModal, #closeGarage {
            position: absolute; top: 10px; right: 15px; font-size: 30px;
            color: white; cursor: pointer;
        }

        /* --- Garage System --- */
        #carSelection { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px; }
        .car-option {
            border: 2px solid #555; border-radius: 10px; padding: 10px;
            cursor: pointer; transition: all 0.3s;
        }
        .car-option.selected { border-color: #4CAF50; background: #333; }
        .car-option.locked { filter: grayscale(1) brightness(0.5); }
        .car-option img { width: 100%; }
        .car-price { font-weight: bold; color: #FFD700; margin-top: 5px; }

        /* --- Other styles from original code --- */
        .game-object { position: absolute; filter: drop-shadow(4px 4px 3px rgba(0,0,0,0.5)); }
        #permissionScreen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: #000; color: white; display: flex; justify-content: center; align-items: center; z-index: 40; cursor: pointer; text-align: center; }
        #popupContainer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 15; }
        .score-popup { position: absolute; color: #FFD700; font-size: 24px; font-weight: bold; text-shadow: 1px 1px 2px black; animation: popup-animation 1s ease-out forwards; }
        @keyframes popup-animation { 0% { transform: translateY(0) scale(1); opacity: 1; } 100% { transform: translateY(-50px) scale(1.5); opacity: 0; } }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        <div id="gameObjectContainer"></div>
        <div id="popupContainer"></div>
        
        <!-- Control Buttons -->
        <div id="leftButton" class="control-btn hidden">◀</div>
        <div id="rightButton" class="control-btn hidden">▶</div>

        <!-- Home Screen -->
        <div id="homeScreen" class="screen">
            <h1>Car Racing</h1>
            <div id="genderSelector">
                <button id="maleBtn" class="gender-btn">Male</button>
                <button id="femaleBtn" class="gender-btn">Female</button>
            </div>
            <div id="difficultySelector">
                <button id="easyButton" class="difficulty-btn"><img src="assets/images/easy_btn.png" alt="Easy"></button>
                <button id="mediumButton" class="difficulty-btn"><img src="assets/images/medium_btn.png" alt="Medium"></button>
                <button id="hardButton" class="difficulty-btn"><img src="assets/images/hard_btn.png" alt="Hard"></button>
            </div>
            <img id="settingsButton" class="icon-btn" src="assets/images/settings_icon.png" alt="Settings">
            <img id="garageButton" class="icon-btn" src="assets/images/garage_icon.png" alt="Garage">
        </div>
        
        <!-- Settings Modal -->
        <div id="settingsModal" class="modal hidden">
            <div class="modal-content">
                <span id="closeModal">&times;</span>
                <h2>Settings</h2>
                <div id="settingsGenderSelector" class="gender-selector">
                    <button id="maleBtnSettings" class="gender-btn">Male</button>
                    <button id="femaleBtnSettings" class="gender-btn">Female</button>
                </div>
            </div>
        </div>

        <!-- Garage Modal -->
        <div id="garageModal" class="modal hidden">
           <div class="modal-content">
                <span id="closeGarage">&times;</span>
                <h2>Garage</h2>
                <p>Total Coins: <span id="totalCoins">0</span></p>
                <div id="carSelection"></div>
            </div>
        </div>

        <!-- Initial Permission Screen -->
        <div id="permissionScreen">
            <h2>Tap to Start</h2>
        </div>
    </div>

    <script>
    // --- Canvas and DOM Elements ---
    const canvas = document.getElementById('gameCanvas'); const ctx = canvas.getContext('2d');
    const gameContainer = document.getElementById('gameContainer');
    const homeScreen = document.getElementById('homeScreen');
    const permissionScreen = document.getElementById('permissionScreen');
    const settingsButton = document.getElementById('settingsButton');
    const garageButton = document.getElementById('garageButton');
    const settingsModal = document.getElementById('settingsModal');
    const garageModal = document.getElementById('garageModal');
    const closeModal = document.getElementById('closeModal');
    const closeGarage = document.getElementById('closeGarage');
    const leftButton = document.getElementById('leftButton');
    const rightButton = document.getElementById('rightButton');
    const gameObjectContainer = document.getElementById('gameObjectContainer');
    const popupContainer = document.getElementById('popupContainer');

    // --- Game State & Variables ---
    let gameState = 'menu';
    let score = 0, totalCoins = 0;
    let selectedGender = 'male';
    let selectedCar = 'player_car.png';
    let difficultyMultiplier = 1.0;
    let assetsLoaded = false;

    // --- Car Data ---
    const cars = [
        { id: 1, name: 'Default Racer', src: 'player_car.png', price: 0, unlocked: true },
        { id: 2, name: 'Blue Falcon', src: 'car_2.png', price: 100, unlocked: false },
        { id: 3, name: 'Green Hornet', src: 'car_3.png', price: 250, unlocked: false },
        { id: 4, name: 'Red Fury', src: 'car_4.png', price: 500, unlocked: false },
        { id: 5, name: 'Golden Arrow', src: 'car_5.png', price: 1000, unlocked: false },
        { id: 6, name: 'Shadow Striker', src: 'car_6.png', price: 2000, unlocked: false },
    ];
    
    // --- Assets ---
    let assets = {};
    const assetSources = {
        road: 'assets/images/road.jpg',
        hitSound: 'assets/audio/carhit.mp3',
        carSound: 'assets/audio/carsound.mp3',
        collectSound: 'assets/audio/collect.wav',
        openingSound: 'assets/audio/opening.wav',
        maleVoice: 'assets/audio/male_voice.mp3',
        femaleVoice: 'assets/audio/female_voice.mp3'
    };

    // --- Game Objects ---
    let playerCar = { element: null, x: 0, y: 0 };
    let coins = [], obstacles = [];
    
    // --- Initialization and Event Listeners ---
    function init() {
        // Gender Selection Events
        document.querySelectorAll('.gender-btn').forEach(btn => {
            btn.addEventListener('click', (e) => selectGender(e.target.id.includes('male') ? 'male' : 'female'));
        });
        
        // Difficulty Buttons Events
        document.getElementById('easyButton').addEventListener('click', () => { difficultyMultiplier = 1.0; startGame(); });
        document.getElementById('mediumButton').addEventListener('click', () => { difficultyMultiplier = 1.1; startGame(); });
        document.getElementById('hardButton').addEventListener('click', () => { difficultyMultiplier = 1.21; startGame(); });
        
        // Modal Events
        settingsButton.addEventListener('click', () => settingsModal.classList.remove('hidden'));
        garageButton.addEventListener('click', () => garageModal.classList.remove('hidden'));
        closeModal.addEventListener('click', () => settingsModal.classList.add('hidden'));
        closeGarage.addEventListener('click', () => garageModal.classList.add('hidden'));

        // Player movement controls
        const handleTouchStart = (e) => e.preventDefault();
        leftButton.addEventListener('mousedown', () => isMovingLeft = true); leftButton.addEventListener('mouseup', () => isMovingLeft = false); leftButton.addEventListener('mouseleave', () => isMovingLeft = false); leftButton.addEventListener('touchstart', (e) => { handleTouchStart(e); isMovingLeft = true; }); leftButton.addEventListener('touchend', () => isMovingLeft = false);
        rightButton.addEventListener('mousedown', () => isMovingRight = true); rightButton.addEventListener('mouseup', () => isMovingRight = false); rightButton.addEventListener('mouseleave', () => isMovingRight = false); rightButton.addEventListener('touchstart', (e) => { handleTouchStart(e); isMovingRight = true; }); rightButton.addEventListener('touchend', () => isMovingRight = false);

        // Load saved data and update UI
        loadGameData();
        updateGarageUI();
        gameLoop();
    }

    // *** IMPORTANT FIX: Handle the first user interaction to unlock audio ***
    permissionScreen.addEventListener('click', () => {
        permissionScreen.innerHTML = "<h2>Loading...</h2>"; // Show loading feedback
        
        // Load assets after the first click
        loadAssets(() => {
            assetsLoaded = true;
            permissionScreen.classList.add('hidden');
            homeScreen.classList.remove('hidden');
            assets.openingSound.play();
        });

    }, { once: true });


    // --- Core Game Logic Functions ---
    function startGame() {
        if (!assetsLoaded) return; // Prevent starting game if assets aren't ready
        if (selectedGender) {
            assets[selectedGender + 'Voice'].play();
        }
        homeScreen.classList.add('hidden');
        leftButton.classList.remove('hidden');
        rightButton.classList.remove('hidden');
        gameState = 'playing';
        resetGame();
        assets.openingSound.pause();
        assets.carSound.currentTime = 0;
        assets.carSound.play();
    }

    function gameOver() {
        gameState = 'gameOver';
        assets.carSound.pause();
        assets.hitSound.play();
        totalCoins += score;
        saveGameData();
        setTimeout(() => {
            showHomeScreen();
            updateGarageUI();
        }, 3000);
    }

    function showHomeScreen() {
        homeScreen.classList.remove('hidden');
        leftButton.classList.add('hidden');
        rightButton.classList.add('hidden');
        gameState = 'menu';
        assets.openingSound.currentTime = 0;
        assets.openingSound.play();
    }

    // --- Garage and Data Management ---
    function updateGarageUI() {
        const carSelectionDiv = document.getElementById('carSelection');
        carSelectionDiv.innerHTML = '';
        document.getElementById('totalCoins').innerText = totalCoins;

        cars.forEach(car => {
            const carDiv = document.createElement('div');
            carDiv.className = 'car-option';
            if (!car.unlocked) carDiv.classList.add('locked');
            if (car.src === selectedCar) carDiv.classList.add('selected');
            
            carDiv.innerHTML = `<img src="assets/images/${car.src}" alt="${car.name}">`;
            if (!car.unlocked) {
                carDiv.innerHTML += `<div class="car-price">Price: ${car.price}</div>`;
            }
            
            carDiv.onclick = () => {
                if (car.unlocked) {
                    selectedCar = car.src;
                    document.querySelectorAll('.car-option').forEach(c => c.classList.remove('selected'));
                    carDiv.classList.add('selected');
                    saveGameData();
                } else if (totalCoins >= car.price) {
                    totalCoins -= car.price;
                    car.unlocked = true;
                    selectedCar = car.src;
                    saveGameData();
                    updateGarageUI();
                } else {
                    alert("Not enough coins!");
                }
            };
            carSelectionDiv.appendChild(carDiv);
        });
    }

    function saveGameData() {
        try {
            const gameData = {
                totalCoins: totalCoins,
                cars: cars.map(c => ({ id: c.id, unlocked: c.unlocked })),
                selectedCar: selectedCar,
                selectedGender: selectedGender
            };
            localStorage.setItem('carGameData', JSON.stringify(gameData));
        } catch (e) {
            console.error("Could not save game data:", e);
        }
    }

    function loadGameData() {
        try {
            const savedData = localStorage.getItem('carGameData');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                totalCoins = gameData.totalCoins || 0;
                selectedCar = gameData.selectedCar || 'player_car.png';
                selectGender(gameData.selectedGender || 'male');
                
                if(gameData.cars) {
                    gameData.cars.forEach(savedCar => {
                        const car = cars.find(c => c.id === savedCar.id);
                        if (car) car.unlocked = savedCar.unlocked;
                    });
                }
            }
        } catch (e) {
            console.error("Could not load game data:", e);
            totalCoins = 0;
        }
    }
    
    // --- Helper Functions ---
    function selectGender(gender) {
        selectedGender = gender;
        document.querySelectorAll('.gender-btn').forEach(btn => btn.classList.remove('selected'));
        if (gender === 'male') {
            document.getElementById('maleBtn').classList.add('selected');
            document.getElementById('maleBtnSettings').classList.add('selected');
        } else {
            document.getElementById('femaleBtn').classList.add('selected');
            document.getElementById('femaleBtnSettings').classList.add('selected');
        }
        saveGameData();
    }
    
    function loadAssets(callback) {
        let assetsLoadedCount = 0;
        const numAssets = Object.keys(assetSources).length;
        
        const assetLoaded = () => {
            assetsLoadedCount++;
            if (assetsLoadedCount >= numAssets) {
                assets.carSound.loop = true;
                callback();
            }
        };
        
        for(let key in assetSources) {
            if(assetSources[key].endsWith('.mp3') || assetSources[key].endsWith('.wav')) {
                assets[key] = new Audio(assetSources[key]);
                assets[key].addEventListener('canplaythrough', assetLoaded, { once: true });
            } else {
                assets[key] = new Image();
                assets[key].src = assetSources[key];
                assets[key].addEventListener('load', assetLoaded, { once: true });
            }
        }
    }

    function resetGame() {
        setDimensions();
        popupContainer.innerHTML = ''; 
        gameObjectContainer.innerHTML = ''; 
        playerCar.element = document.createElement('img');
        playerCar.element.id = 'playerCarElement'; 
        playerCar.element.className = 'game-object'; 
        playerCar.element.src = `assets/images/${selectedCar}`;
        playerCar.element.style.width = `${D_DIMS.playerCarWidth}px`; 
        playerCar.element.style.height = `${D_DIMS.playerCarHeight}px`; 
        gameObjectContainer.appendChild(playerCar.element); 
        playerCar.x = (canvas.width / 2) - (D_DIMS.playerCarWidth / 2); 
        playerCar.y = canvas.height - D_DIMS.playerCarHeight - 80; 
        playerCar.element.style.left = `${playerCar.x}px`; 
        playerCar.element.style.top = `${playerCar.y}px`; 
        obstacles = []; 
        obstacleSpawnTimer = 0; 
        coins = []; 
        coinSpawnTimer = 0; 
        score = 0; 
        road.y1 = 0; 
        road.y2 = -canvas.height;
    }

    // --- Unchanged Functions ---
    let isMovingLeft = false, isMovingRight = false;
    const road = { y1: 0, y2: 0 };
    let D_DIMS = {}; 
    let coinSpawnTimer = 0; const coinSpawnInterval = 180;
    let obstacleSpawnTimer = 0; const obstacleSpawnInterval = 120;
    const BASE_PLAYER_SPEED_MULTIPLIER = 0.0216;
    const BASE_ROAD_SPEED_MULTIPLIER = 0.006;
    
    function setDimensions() {
        canvas.width = gameContainer.clientWidth; canvas.height = gameContainer.clientHeight;
        D_DIMS.roadLeftBoundary = canvas.width * 0.30; D_DIMS.roadRightBoundary = canvas.width * 0.70;
        D_DIMS.playerCarWidth = canvas.width * 0.11; D_DIMS.playerCarHeight = D_DIMS.playerCarWidth * 2;
        D_DIMS.playerCarSpeed = canvas.width * BASE_PLAYER_SPEED_MULTIPLIER * difficultyMultiplier;
        D_DIMS.obstacleBaseSpeed = canvas.height * BASE_ROAD_SPEED_MULTIPLIER * difficultyMultiplier;
        D_DIMS.obstacleWidth = D_DIMS.playerCarWidth * 0.75; D_DIMS.obstacleHeight = D_DIMS.playerCarHeight * 0.75;
        D_DIMS.coinSize = canvas.width * 0.15;
        D_DIMS.coinSpeed = D_DIMS.obstacleBaseSpeed; 
        D_DIMS.roadSpeed = D_DIMS.obstacleBaseSpeed;
    }
    
    createScorePopup = function(x, y) { const popup = document.createElement('div'); popup.innerText = '+5'; popup.className = 'score-popup'; popup.style.left = `${x}px`; popup.style.top = `${y}px`; popupContainer.appendChild(popup); setTimeout(() => { popup.remove(); }, 1000); }
    update = function() { road.y1 += D_DIMS.roadSpeed; road.y2 += D_DIMS.roadSpeed; if (road.y1 >= canvas.height) road.y1 = road.y2 - canvas.height; if (road.y2 >= canvas.height) road.y2 = road.y1 - canvas.height; if (gameState !== 'playing') return; if (isMovingLeft) playerCar.x -= D_DIMS.playerCarSpeed; if (isMovingRight) playerCar.x += D_DIMS.playerCarSpeed; playerCar.x = Math.max(D_DIMS.roadLeftBoundary, Math.min(playerCar.x, D_DIMS.roadRightBoundary - D_DIMS.playerCarWidth)); playerCar.element.style.left = `${playerCar.x}px`; obstacleSpawnTimer++; if (obstacleSpawnTimer > obstacleSpawnInterval) { obstacles.push(createGameObject('obstacle-car', `assets/images/obstacle${Math.floor(Math.random() * 4) + 1}.png`, D_DIMS.obstacleWidth, D_DIMS.obstacleHeight, D_DIMS.obstacleBaseSpeed + Math.random() * 2)); obstacleSpawnTimer = 0; } coinSpawnTimer++; if (coinSpawnTimer > coinSpawnInterval) { coins.push(createGameObject('coin', 'assets/images/coin.gif', D_DIMS.coinSize, D_DIMS.coinSize, D_DIMS.coinSpeed)); coinSpawnTimer = 0; } for (let i = coins.length - 1; i >= 0; i--) { const coin = coins[i]; coin.y += coin.speed; coin.element.style.top = `${coin.y}px`; if (checkCollision(playerCar, coin)) { score += 5; assets.collectSound.currentTime = 0; assets.collectSound.play(); createScorePopup(coin.x, coin.y); gameObjectContainer.removeChild(coin.element); coins.splice(i, 1); } else if (coin.y > canvas.height) { gameObjectContainer.removeChild(coin.element); coins.splice(i, 1); } } for (let i = obstacles.length - 1; i >= 0; i--) { const obstacle = obstacles[i]; obstacle.y += obstacle.speed; obstacle.element.style.top = `${obstacle.y}px`; if (checkCollision(playerCar, obstacle)) { gameOver(); return; } else if (obstacle.y > canvas.height) { gameObjectContainer.removeChild(obstacle.element); obstacles.splice(i, 1); } } }
    draw = function() { ctx.clearRect(0, 0, canvas.width, canvas.height); ctx.filter = `saturate(130%) brightness(110%) contrast(120%)`; ctx.drawImage(assets.road, 0, road.y1, canvas.width, canvas.height); ctx.drawImage(assets.road, 0, road.y2, canvas.width, canvas.height); ctx.filter = 'none'; if (gameState !== 'menu') { draw3DScoreBox(score); } }
    gameLoop = function() { if(assetsLoaded) { update(); draw(); } if (gameState === 'gameOver') { drawGameOver(); } requestAnimationFrame(gameLoop); }
    createGameObject = function(type, src, width, height, speed = 0) { const element = document.createElement('img'); element.src = src; element.className = `game-object ${type}`; element.style.width = `${width}px`; element.style.height = `${height}px`; const randomX = Math.random() * (D_DIMS.roadRightBoundary - D_DIMS.roadLeftBoundary - width) + D_DIMS.roadLeftBoundary; element.style.left = `${randomX}px`; element.style.top = `-${height}px`; gameObjectContainer.appendChild(element); return { element, x: randomX, y: -height, width, height, speed }; }
    function checkCollision(obj1, obj2) { const rect1 = obj1.element.getBoundingClientRect(); const rect2 = obj2.element.getBoundingClientRect(); return !(rect1.right < rect2.left || rect1.left > rect2.right || rect1.bottom < rect2.top || rect1.top > rect2.bottom); }
    function draw3DScoreBox(scoreValue) { const boxWidth = canvas.width * 0.4; const boxHeight = canvas.height * 0.07; const x = 10; const y = 10; const radius = 8; ctx.shadowColor = 'rgba(0, 0, 0, 0.8)'; ctx.shadowBlur = 10; ctx.shadowOffsetX = 2; ctx.shadowOffsetY = 2; ctx.fillStyle = 'rgba(0, 0, 0, 0.7)'; ctx.beginPath(); ctx.moveTo(x + radius, y); ctx.lineTo(x + boxWidth - radius, y); ctx.arcTo(x + boxWidth, y, x + boxWidth, y + radius, radius); ctx.lineTo(x + boxWidth, y + boxHeight - radius); ctx.arcTo(x + boxWidth, y + boxHeight, x + boxWidth - radius, y + boxHeight, radius); ctx.lineTo(x + radius, y + boxHeight); ctx.arcTo(x, y + boxHeight, x, y + boxHeight - radius, radius); ctx.lineTo(x, y + radius); ctx.arcTo(x, y, x + radius, y, radius); ctx.closePath(); ctx.fill(); ctx.shadowColor = 'transparent'; ctx.shadowBlur = 0; ctx.shadowOffsetX = 0; ctx.shadowOffsetY = 0; ctx.fillStyle = 'white'; ctx.font = `bold ${canvas.height * 0.035}px Arial`; ctx.textAlign = 'center'; ctx.textBaseline = 'middle'; ctx.fillText('Score: ' + scoreValue, x + boxWidth / 2, y + boxHeight / 2); }
    function drawGameOver() { ctx.fillStyle = 'rgba(0, 0, 0, 0.6)'; ctx.fillRect(0, 0, canvas.width, canvas.height); ctx.fillStyle = 'white'; ctx.font = `bold ${canvas.width * 0.15}px Arial`; ctx.textAlign = 'center'; ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2 - 20); ctx.font = `bold ${canvas.width * 0.06}px Arial`; ctx.fillText('Saving Score...', canvas.width / 2, canvas.height / 2 + 40); }

    // Start the initial setup
    init();

</script>
</body>
</html>
